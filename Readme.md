# Задача для Jenkins выгрузки ИБ в файл dt

Задача состоит из 4 шагов и финальной фазы (post):

1. Подготовка ИБ (блокировка соединений и регламентных заданий, удаление пользовательских сессий)
2. Создание DT файла выгрузки (делается 5 попыток с таймаутом, в зависимости от информационной базы)
3. Применение изменений в конфигурации разработчика к конфигурации базы данных
4. Копирование DT файла выгрузки на сетевое хранилище  
P. Вне зависимости от успешности шагов, с ИБ снимается блокировка сеансов и регламентных заданий. Результат работы отправляется в [telegram](https://telegram.org/) с помощью плагина [Notify.Events](https://plugins.jenkins.io/notify-events)

> Имя информационной базы для выгрузки берется из переменной окружения `JOB_BASE_NAME`, поэтому название задания 
Jenkins должно соответствовать имени выгружаемой ИБ. Сервер приложений __всегда__ `obr-app-11` (переменная 
`CLADDR` в начале [Jenkinsfile](https://github.com/vsuh/DUMB_IB/blob/acef3f81ce209c29bab2787f09e4a460d516ae6f/src/Jenkinsfile#L9)

Задача использует функционал библиотеки [OneScript](https://oscript.io) [vanessa-runner](https://github.com/vanessa-opensource/vanessa-runner) которые должны быть установлены на исполняющем узле Jenkins.
